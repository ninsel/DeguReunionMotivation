function g = plotVocSpec(filename, tsne_y, indy, specrange)
%
%
%
%

cm = [    1.0000    1.0000    1.0000
    0.9452    0.9452    0.9452
    0.8903    0.8903    0.8903
    0.8355    0.8355    0.8355
    0.7807    0.7807    0.7807
    0.7258    0.7258    0.7258
    0.6710    0.6710    0.6710
    0.6162    0.6162    0.6162
    0.5613    0.5613    0.5613
    0.5065    0.5065    0.5065
    0.4517    0.4517    0.4517
    0.3968    0.3968    0.3968
    0.3860    0.3860    0.3860
    0.3752    0.3752    0.3752
    0.3644    0.3644    0.3644
    0.3537    0.3537    0.3537
    0.3429    0.3429    0.3429
    0.3321    0.3321    0.3321
    0.3213    0.3213    0.3213
    0.3105    0.3105    0.3105
    0.2997    0.2997    0.2997
    0.2889    0.2889    0.2889
    0.2781    0.2781    0.2781
    0.2673    0.2673    0.2673
    0.2565    0.2565    0.2565
    0.2457    0.2457    0.2457
    0.2349    0.2349    0.2349
    0.2241    0.2241    0.2241
    0.2133    0.2133    0.2133
    0.2026    0.2026    0.2026
    0.1918    0.1918    0.1918
    0.1810    0.1810    0.1810
    0.1702    0.1702    0.1702
    0.1594    0.1594    0.1594
    0.1486    0.1486    0.1486
    0.1378    0.1378    0.1378
    0.1270    0.1270    0.1270
    0.1162    0.1162    0.1162
    0.1054    0.1054    0.1054
    0.0946    0.0946    0.0946
    0.0838    0.0838    0.0838
    0.0730    0.0730    0.0730
    0.0622    0.0622    0.0622
    0.0593    0.0593    0.0593
    0.0563    0.0563    0.0563
    0.0534    0.0534    0.0534
    0.0504    0.0504    0.0504
    0.0474    0.0474    0.0474
    0.0445    0.0445    0.0445
    0.0415    0.0415    0.0415
    0.0385    0.0385    0.0385
    0.0356    0.0356    0.0356
    0.0326    0.0326    0.0326
    0.0296    0.0296    0.0296
    0.0267    0.0267    0.0267
    0.0237    0.0237    0.0237
    0.0207    0.0207    0.0207
    0.0178    0.0178    0.0178
    0.0148    0.0148    0.0148
    0.0119    0.0119    0.0119
    0.0089    0.0089    0.0089
    0.0059    0.0059    0.0059
    0.0030    0.0030    0.0030
         0         0         0];

     
if nargin < 4
    specrange = 50:50:16000;
end     

if ischar(filename)
    [yy fs] = audioread(filename);
else
    yy = filename;
end
    
[S, F, T] = spectrogram(yy(:,1), 44100/200, 0, specrange, 44100);


 g = figure;
% sp1 = subplot(3,1,1:3);
 n = imagesc(abs(S));
 hold
 sp1 = get(n,'parent');
 colormap(sp1, cm);
% %set(sp1, 'XTick', 333:333:4000);
% 
 n_x_tick = get(sp1, 'XTickLabel');
 n_y_tick = get(sp1, 'YTickLabel');
 for i =1:size(n_x_tick,1)    
     newxtick(i) = round(1000*(T(round(str2double(n_x_tick(i,:))))-T(1)));
 end
 for i = 1:size(n_y_tick, 1)
 	newytick(i) = round(F(str2double(n_y_tick(i,:)))); 
 end
 set(sp1, 'XTickLabel', newxtick);
 set(sp1, 'YTickLabel', newytick);
 set(sp1, 'YDir', 'normal');
 colorbar
 box off
 
 sp2 = axes('Position', [.64, .75, .15, .15]);
plot(tsne_y(:,1), tsne_y(:,2), '.', 'Color', [.8 .8 .8]);
hold
plot(tsne_y(indy,1), tsne_y(indy,2), 'r*');
box off